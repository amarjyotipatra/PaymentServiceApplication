# Payment Service Application

This is a Spring Boot-based microservice designed to handle payment operations, including payment link generation and webhook processing. It is designed to be flexible and support multiple payment gateways.

## Features

*   **Payment Link Generation:**  Generates payment links for easy payment processing.
*   **Payment Gateway Abstraction:**  Uses an interface (`IPaymentGateway`) to abstract the payment gateway logic, allowing easy integration of different payment providers (currently configured for Razorpay).
* **Stripe webhooks:** Able to receive events from stripe using webhooks.
*   **RESTful API:** Exposes a RESTful API for payment-related operations.
*   **Spring Boot:** Built using the Spring Boot framework for simplified development and deployment.
*   **Dependency Injection:** Utilizes Spring's dependency injection for loose coupling and testability.
* **Gradle**: Uses gradle as a build tool.

## Prerequisites

*   **Java JDK 21:** Ensure you have Java Development Kit (JDK) version 21 installed.
*   **Payment Gateway Accounts:**
    *   **Razorpay:** A Razorpay account with API keys (ID and secret).
    *   **Stripe** : A Stripe account with API keys.
* **Gradle:** Gradle is included as a wrapper (`gradlew`), but you can use a globally installed version if you prefer.

## Getting Started

1.  **Clone the Repository:**

    ```bash
    git clone <repository-url>
    cd PaymentServiceApplication
    ```

2.  **Configure Application Properties:**

    *   Rename `src/main/resources/application.properties.example` to `src/main/resources/application.properties`.
    *   Open `application.properties` and set the following properties:
        *   `spring.application.name`: Name of the application (e.g., `PaymentServiceApplication`).
        *   `razorpay.id`: Your Razorpay Key ID.
        *   `razorpay.secret`: Your Razorpay Key Secret.
        * `stripe.apiKey`: Your Stripe API key.
        * You can also set local properties here, or using environment variables.

    * **Important:** Do not commit sensitive information directly in the `application.properties` file. Consider using environment variables for sensitive data. Refer to the Security section for more details.
3.  **Build the Project:**

    ```bash
    ./gradlew clean build
    ```

4.  **Run the Application:**

    ```bash
    ./gradlew bootRun
    ```

5.  **Access the Application:** Once running, the application will be accessible at `http://localhost:8080`.

## API Endpoints

### Payment

*   `POST /payment`: Initiate a payment (currently supports payment link generation using Razorpay).
    *   **Request Body:**

    ```json
    {
      "name": "John Doe",
      "email": "john.doe@example.com",
      "phoneNumber": "1234567890",
      "orderId": "order123",
      "amount": 1000
    }
    ```

    *   **Response:** Returns the Razorpay payment link.
    * **Response**: Returns the payment link generated by Razorpay.

### Webhooks

*   `POST /stripeWebhook`: Receive events from Stripe.
    *   **Request Body:** A JSON payload representing a Stripe event.

## Security

*   **Sensitive Data:** Never commit sensitive data (like API keys) directly to your repository. Use environment variables or other secure configuration methods.
*   **Environment Variables (Recommended):** You can use environment variables to set the following properties:
    *   `razorpay.id`: Your Razorpay Key ID.
    *   `razorpay.secret`: Your Razorpay Key Secret.
    * `stripe.apiKey`: Your Stripe API key.
* **Local configuration**: You can also create a local configuration file, and not commit it to your repository.
* **application.properties.example**: This file contains example of properties that can be set.
## Payment Gateway Integration

*   **`IPaymentGateway`:** This interface defines the contract for interacting with different payment gateways.
*   **Extensibility:** You can add new payment gateways by implementing the `IPaymentGateway` interface and configuring the dependency injection in your Spring Boot application.

## Webhooks

*   **Stripe Webhooks:** The `WebhookController` handles incoming events from Stripe.
* **Security**: Make sure to secure your webhook endpoint.

